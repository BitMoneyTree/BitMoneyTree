<html lang="zh"> <head> <meta charset="utf-8"/> <link rel="shortcut icon" href="https://www.mdeditor.com/images/logos/favicon.ico" type="image/x-icon"/> </head> <body><h2 id="h2-bitmoneytree-luamodule-api"><a name="BitMoneyTree—LuaModule API" class="reference-link"></a><span class="header-link octicon octicon-link"></span>BitMoneyTree—LuaModule API</h2><p><em>Reading in other languages：<a href="https://github.com/BitMoneyTree/BitMoneyTree/blob/master/LuaModule%20API_en.md" title="English">English</a>,<a href="https://github.com/BitMoneyTree/BitMoneyTree/blob/master/LuaModule%20API_hk.md" title="繁體中文">繁體中文</a>,<a href="https://github.com/BitMoneyTree/BitMoneyTree/blob/master/LuaModule%20API_cn.md" title="简体中文">简体中文</a></em></p> <h3 id="h3-luadb-module"><a name="LuaDB module" class="reference-link"></a><span class="header-link octicon octicon-link"></span>LuaDB module</h3><p>Create a database object such as: <code>db=dbhelper (database name)</code></p> <h4 id="h4-db-openquery-str-"><a name="db:openQuery (str)" class="reference-link"></a><span class="header-link octicon octicon-link"></span>db:openQuery (str)</h4><p>Executes SQL statements and returns the result after execution, which is basically used for query statements<br>Parameters: </p><table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>str</td> <td>SQL statement</td> <td>string</td> </tr> </tbody> </table> <p>Response table data:<br><code>{ [1]={ XDJL06="14.2089", XDJL04="2106261898", XDJL15="15.2089", XDJL14="1597991460", XDJL02="Binance", XDJL03="linkusdt", XDJL12="210626", XDJL07="1", XDJL01=1898, XDJL11="Traded", XDJL10="2020/8/21 星期五 18:00:29", XDJL09="TestData", XDJL08="DoubleKLineBOLL", XDJL05="sell"}, [2]={ XDJL06="16.0563", XDJL04="2106261899", XDJL15="15.0563", XDJL14="1597992120", XDJL02="Binance", XDJL03="linkusdt", XDJL12="210626", XDJL07="1", XDJL01=1899, XDJL11="Traded", XDJL10="2020/8/21 星期五 18:00:31", XDJL09="TestData", XDJL08="DoubleKLineBOLL", XDJL05="buy"}, CRC32=-1511945275, fields={ [1]={ field_type=3, field_size=4, field_name="XDJL01"}, [2]={ field_type=202, field_size=7, field_name="XDJL02"}, [3]={ field_type=202, field_size=8, field_name="XDJL03"}, [4]={ field_type=202, field_size=14, field_name="XDJL04"}, [5]={ field_type=202, field_size=4, field_name="XDJL05"}, [6]={ field_type=202, field_size=8, field_name="XDJL06"}, [7]={ field_type=202, field_size=6, field_name="XDJL07"}, [8]={ field_type=202, field_size=15, field_name="XDJL08"}, [9]={ field_type=202, field_size=8, field_name="XDJL09"}, [10]={ field_type=135, field_size=25, field_name="XDJL10"}, [11]={ field_type=202, field_size=11, field_name="XDJL11"}, [12]={ field_type=202, field_size=10, field_name="XDJL12"}, [13]={ field_type=202, field_size=117, field_name="XDJL13"}, [14]={ field_type=202, field_size=10, field_name="XDJL14"}, [15]={ field_type=202, field_size=8, field_name="XDJL15"}, field_count=15}}</code></p> <h4 id="h4-db-executenoquery-str-"><a name="db:executeNoQuery(str)" class="reference-link"></a><span class="header-link octicon octicon-link"></span>db:executeNoQuery(str)</h4><p>Executing SQL statements does not return data, and is generally used to delete statements<br>Parameters: </p><table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>STR</td> <td>SQL statement</td> <td>string</td> </tr> </tbody> </table> <p>No response data</p> <h4 id="h4-db-insert-tablename-databasetablename-"><a name="db:insert(tableName,DatabaseTableName)" class="reference-link"></a><span class="header-link octicon octicon-link"></span>db:insert(tableName,DatabaseTableName)</h4><p>To insert data into a table in the database, first create a table and put the data to be inserted into the table, for example: table. table field name = data to be inserted<br>Parameters: </p><table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>TableName</td> <td>created table name</td> <td>string</td> </tr> <tr> <td>DatabaseTableName</td> <td>database table name</td> <td>string</td> </tr> </tbody> </table> <p>No response data</p> <h4 id="h4-db-update-tablename-databasetablename-condition-"><a name="db:update(tableName,DatabaseTableName,condition)" class="reference-link"></a><span class="header-link octicon octicon-link"></span>db:update(tableName,DatabaseTableName,condition)</h4><p>To modify the data of a table in the database, first create a table and put the fields to be modified into the table, for example: table. table field name = data to be modified<br>Parameters: </p><table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>TableName</td> <td>created table name</td> <td>string</td> </tr> <tr> <td>DatabaseTableName</td> <td>database table name</td> <td>string</td> </tr> <tr> <td>Condition</td> <td>modify condition</td> <td>string</td> </tr> </tbody> </table> <p>No response data</p> <h3 id="h3-memtable-module"><a name="MemTable module" class="reference-link"></a><span class="header-link octicon octicon-link"></span>MemTable module</h3><h4 id="h4-memtable-type-tablename-"><a name="Memtable (type, tableName)" class="reference-link"></a><span class="header-link octicon octicon-link"></span>Memtable (type, tableName)</h4><p>Create a Memtable object such as: <code>tb=Memtable ("BuyDept", "Huobi_xrpusdt_1min ")</code><br>Parameters: </p><table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>Type</td> <td>table type (depth of purchase and selling: BuyDept and SellDept; one by one purchase and selling: BuySellOne; K line: KLine; ExchangeRate)</td> <td>string</td> </tr> <tr> <td>TableName</td> <td>the name of the table to be created</td> <td>string</td> </tr> </tbody> </table> <p>No response data</p> <h4 id="h4-tb-add-"><a name="tb:add()" class="reference-link"></a><span class="header-link octicon octicon-link"></span>tb:add()</h4><p>Insert data into Memtable<br>For example: <code>tb:add (price, amount, timestamp)</code><br>Different table type parameters are different:<br>BuyDept, SellDept: </p><table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>Parameter 1</td> <td>price</td> <td>number</td> </tr> <tr> <td>Parameter 2</td> <td>number</td> <td>number</td> </tr> <tr> <td>Parameter 3</td> <td>time stamp (second)</td> <td>number</td> </tr> </tbody> </table> <p>BuySellOne:</p> <table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>Parameter 1</td> <td>buy one price</td> <td>number</td> </tr> <tr> <td>Parameter 2</td> <td>buy a quantity</td> <td>number</td> </tr> <tr> <td>Parameter 3</td> <td>sell one price</td> <td>number</td> </tr> <tr> <td>Parameter 4</td> <td>sell one quantity</td> <td>number</td> </tr> <tr> <td>Parameter 5</td> <td>time stamp (second)</td> <td>number</td> </tr> </tbody> </table> <p>KLine:</p> <table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>Parameter 1</td> <td>opening price</td> <td>number</td> </tr> <tr> <td>Parameter 2</td> <td>closing price</td> <td>number</td> </tr> <tr> <td>Parameter 3</td> <td>maximum price</td> <td>number</td> </tr> <tr> <td>Parameter 4</td> <td>lowest price</td> <td>number</td> </tr> <tr> <td>Parameter 5</td> <td>trading volume</td> <td>number</td> </tr> <tr> <td>Parameter 6</td> <td>time stamp (second)</td> <td>number</td> </tr> </tbody> </table> <p>ExchangeRate:</p> <table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>Parameter 1</td> <td>trade to</td> <td>number</td> </tr> <tr> <td>Parameter 2</td> <td>price</td> <td>number</td> </tr> <tr> <td>Parameter 3</td> <td>time stamp (second)</td> <td>number</td> </tr> </tbody> </table> <p>No response parameters</p> <h4 id="h4-tb-query-"><a name="tb:query()" class="reference-link"></a><span class="header-link octicon octicon-link"></span>tb:query()</h4><p>Query Memtable data<br>Parameters: None<br>Response table data:<br><code>{ [1]={ sellsize=168.02, buysize=439.81, sell=0.26956, ts=1599114991, buy=0.26948}, fields={ [1]={ field_type=5, field_size=20, field_name="buy"}, [2]={ field_type=5, field_size=20, field_name="buysize"}, [3]={ field_type=5, field_size=20, field_name="sell"}, [4]={ field_type=5, field_size=20, field_name="sellsize"}, [5]={ field_type=5, field_size=20, field_name="ts"}, field_count=5}}</code></p> <h4 id="h4-tb-clear-"><a name="tb:clear()" class="reference-link"></a><span class="header-link octicon octicon-link"></span>tb:clear()</h4><p>Clear Memtable data<br>Parameters: None<br>No response data </p><h3 id="h3-inet-module"><a name="inet module" class="reference-link"></a><span class="header-link octicon octicon-link"></span>inet module</h3><h4 id="h4-inet-requesturl-url-"><a name="inet.requestUrl(URL)" class="reference-link"></a><span class="header-link octicon octicon-link"></span>inet.requestUrl(URL)</h4><p>Request link<br>Parameters: </p><table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>URL</td> <td>link address</td> <td>string</td> </tr> </tbody> </table> <p>Response to JSON data:<br><code>{"resultCode":"ok","data":{"serverTime":"1599116231440"}}</code></p> <h4 id="h4-inet-hash_hmac-parameter-1-parameter-2-parameter-3-"><a name="inet.hash_hmac(Parameter 1,Parameter 2,Parameter 3);" class="reference-link"></a><span class="header-link octicon octicon-link"></span>inet.hash_hmac(Parameter 1,Parameter 2,Parameter 3);</h4><p>Encryption based on key and encryption method<br>Parameters: </p><table> <thead> <tr> <th>Field name</th> <th>description</th> <th>data type</th> </tr> </thead> <tbody> <tr> <td>Parameter 1</td> <td>encryption method (sha256; MD5; SHA512, etc.)</td> <td>string</td> </tr> <tr> <td>Parameter 2</td> <td>string to be encrypted</td> <td>string</td> </tr> <tr> <td>Parameter 3</td> <td>key</td> <td>string</td> </tr> </tbody> </table> <h4 id="h4-inet-timestamp-"><a name="inet.timestamp()" class="reference-link"></a><span class="header-link octicon octicon-link"></span>inet.timestamp()</h4><p>Get time stamp<br>Parameters: None<br>Response number data:<br><code>1599117673.123</code></p> <h4 id="h4-inet-utf8toansi-parameter-1-"><a name="inet.utf8toansi(Parameter 1)" class="reference-link"></a><span class="header-link octicon octicon-link"></span>inet.utf8toansi(Parameter 1)</h4><p>Converting utf8 code data to ANSI code</p> <table> <thead> <tr> <th>Field name</th> <th>description</th> </tr> </thead> <tbody> <tr> <td>Parameter 1</td> <td>data to be converted</td> </tr> </tbody> </table> </body> </html>
