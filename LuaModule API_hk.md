<html lang="zh"> <head> <meta charset="utf-8"/> <link rel="shortcut icon" href="https://www.mdeditor.com/images/logos/favicon.ico" type="image/x-icon"/> </head> <body><h2 id="h2-bitmoneytree-luamodule-api"><a name="BitMoneyTree—LuaModule API" class="reference-link"></a><span class="header-link octicon octicon-link"></span>BitMoneyTree—LuaModule API</h2><p><em>用其他語言閱讀：<a href="https://github.com/BitMoneyTree/BitMoneyTree/blob/master/LuaModule%20API_en.md" title="English">English</a>,<a href="https://github.com/BitMoneyTree/BitMoneyTree/blob/master/LuaModule%20API_hk.md" title="繁體中文">繁體中文</a>,<a href="https://github.com/BitMoneyTree/BitMoneyTree/blob/master/LuaModule%20API_cn.md" title="简体中文">简体中文</a></em></p> <h3 id="h3-luadb-"><a name="LuaDB模塊" class="reference-link"></a><span class="header-link octicon octicon-link"></span>LuaDB模塊</h3><p>創建資料庫對象例如：<code>db=dbhelper（資料庫名）</code></p> <h4 id="h4-db-openquery-str-"><a name="db:openQuery（str）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>db:openQuery（str）</h4><p>執行SQL語句並返回執行後的結果，基本用於査詢語句<br>參數： </p><table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>str</td> <td>SQL語句</td> <td>string</td> </tr> </tbody> </table> <p>響應table數據：<br><code>{ [1]={ XDJL06=“14.2089”，XDJL04=“2106261898”，XDJL15=“15.2089”，XDJL14=“1597991460”，XDJL02=“Binance”，XDJL03=“linkusdt”，XDJL12=“210626”，XDJL07=“1”，XDJL01=1898，XDJL11=“Traded”，XDJL10=“2020/8 /21星期五18:00:29”，XDJL09=“TestData”，XDJL08=“DoubleKLineBOLL”，XDJL05=“sell”}，[2]={ XDJL06=“16.0563”，XDJL04=“2106261899”，XDJL15=“15.0563”，XDJL14=“1597992120”，XDJL02=“Binance”，XDJL03=“linkusdt”，XDJL12=“210626”，XDJL07=“1”，XDJL01=1899，XDJL11=“Traded”，XDJL10=“2020/8/21星期五18:00:31”，XDJL09=“TestData”，XDJL08=“DoubleKLineBOLL”，XDJL05=“buy”}，CRC32=-1511945275，fields={ [1]={ field_type=3，field_size=4，field_name=“XDJL01”}，[2]={ field_type=202，field_size=7，field_name=“XDJL02”}，[3]={ field_type=202，field_size=8，field_name=“XDJL03”}，[4]={ field_type=202，field_size=14，field_name=“XDJL04”}，[5]={ field_type=202，field_size=4，field_name=“XDJL05”}，[6]={ field_type=202，field_size=8，field_name=“XDJL06”}，[7]={ field_type=202，field_size=6，field_name=“XDJL07”}，[8]={ field_type=202，field_size=15，field_name=“XDJL08”}，[9]={ field_type=202，field_size=8，field_name=“XDJL09”}，[10]={ field_type=135，field_size=25，field_name=“XDJL10”}，[11]={ field_type=202，field_size=11，field_name=“XDJL11”}，[12]={ field_type=202，field_size=10，field_name=“XDJL12”}，[13]={ field_type=202，field_size=117，field_name=“XDJL13”}，[14]={ field_type=202，field_size=10，field_name=“XDJL14”}，[15]={ field_type=202，field_size=8，field_name=“XDJL15”}，field_count=15}}</code></p> <h4 id="h4-db-executenoquery-str-"><a name="db:executeNoQuery（str）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>db:executeNoQuery（str）</h4><p>執行SQL語句不返回數據，一般用於删除語句<br>參數： </p><table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>str</td> <td>SQL語句</td> <td>string</td> </tr> </tbody> </table> <p>無響應數據</p> <h4 id="h4-db-insert-tablename-databasetablename-"><a name="db:insert（tableName，DatabaseTableName）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>db:insert（tableName，DatabaseTableName）</h4><p>向資料庫裏的某個錶插入數據，首先創建一個table，把需要插入的數據放入table裏，例如：table.錶欄位名=需要插入的數據<br>參數： </p><table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>tableName</td> <td>創建的table名</td> <td>string</td> </tr> <tr> <td>DatabaseTableName</td> <td>資料庫錶名</td> <td>string</td> </tr> </tbody> </table> <p>無響應數據</p> <h4 id="h4-db-update-tablename-databasetablename-condition-"><a name="db:update（tableName，DatabaseTableName，condition）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>db:update（tableName，DatabaseTableName，condition）</h4><p>修改資料庫裏某個錶的數據，首先創建一個table，把需要修改的欄位放入table裏，例如：table.錶欄位名=需要修改的數據<br>參數： </p><table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>tableName</td> <td>創建的table名</td> <td>string</td> </tr> <tr> <td>DatabaseTableName</td> <td>資料庫錶名</td> <td>string</td> </tr> <tr> <td>condition</td> <td>修改條件</td> <td>string</td> </tr> </tbody> </table> <p>無響應數據</p> <h3 id="h3-memtable-"><a name="MemTable模塊" class="reference-link"></a><span class="header-link octicon octicon-link"></span>MemTable模塊</h3><h4 id="h4-memtable-type-tablename-"><a name="Memtable（type，tableName）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>Memtable（type，tableName）</h4><p>創建一個Memtable對象例如：<code>tb=Memtable（“BuyDept”，“Huobi_xrpusdt_1min“）</code><br>參數： </p><table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>type</td> <td>錶類型（買盤深度賣盤深度：BuyDept、SellDept；買一賣一逐筆行情：BuySellOne；K線：KLine；匯率：ExchangeRate）</td> <td>string</td> </tr> <tr> <td>tableName</td> <td>要創建的錶名</td> <td>string</td> </tr> </tbody> </table> <p>無響應數據</p> <h4 id="h4-tb-add-"><a name="tb:add（）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>tb:add（）</h4><p>對Memtable錶插入數據<br>例如：<code>tb:add（price，amount，timestamp）</code><br>不同錶類型參數不同：<br>BuyDept、SellDept: </p><table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>參數1</td> <td>價格</td> <td>number</td> </tr> <tr> <td>參數2</td> <td>數量</td> <td>number</td> </tr> <tr> <td>參數3</td> <td>時間戳記（秒）</td> <td>number</td> </tr> </tbody> </table> <p>BuySellOne:</p> <table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>參數1</td> <td>買一價</td> <td>number</td> </tr> <tr> <td>參數2</td> <td>買一量</td> <td>number</td> </tr> <tr> <td>參數3</td> <td>賣一價</td> <td>number</td> </tr> <tr> <td>參數4</td> <td>賣一量</td> <td>number</td> </tr> <tr> <td>參數5</td> <td>時間戳記（秒）</td> <td>number</td> </tr> </tbody> </table> <p>KLine：</p> <table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>參數1</td> <td>開盤價</td> <td>number</td> </tr> <tr> <td>參數2</td> <td>收盤價</td> <td>number</td> </tr> <tr> <td>參數3</td> <td>最高價</td> <td>number</td> </tr> <tr> <td>參數4</td> <td>最低價</td> <td>number</td> </tr> <tr> <td>參數5</td> <td>交易量</td> <td>number</td> </tr> <tr> <td>參數6</td> <td>時間戳記（秒）</td> <td>number</td> </tr> </tbody> </table> <p>ExchangeRate：</p> <table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>參數1</td> <td>交易對</td> <td>number</td> </tr> <tr> <td>參數2</td> <td>價格</td> <td>number</td> </tr> <tr> <td>參數3</td> <td>時間戳記（秒）</td> <td>number</td> </tr> </tbody> </table> <p>無響應參數</p> <h4 id="h4-tb-query-"><a name="tb:query（）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>tb:query（）</h4><p>査詢Memtable錶數據<br>參數：無<br>響應table數據：<br><code>{ [1]={ sellsize=168.02，buysize=439.81，sell=0.26956，ts=1599114991，buy=0.26948}，fields={ [1]={ field_type=5，field_size=20，field_name=“buy”}，[2]={ field_type=5，field_size=20，field_name=“buysize”}，[3]={ field_type=5，field_size=20，field_name=“sell”}，[4]={ field_type=5，field_size=20，field_name=“sellsize”}，[5]={ field_type=5，field_size=20，field_name=“ts”}，field_count=5}}</code></p> <h4 id="h4-tb-clear-"><a name="tb:clear（）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>tb:clear（）</h4><p>清除Memtable錶數據<br>參數：無<br>無響應數據 </p><h3 id="h3-inet-"><a name="inet模塊" class="reference-link"></a><span class="header-link octicon octicon-link"></span>inet模塊</h3><h4 id="h4-inet-requesturl-url-"><a name="inet.requestUrl（url）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>inet.requestUrl（url）</h4><p>請求連結<br>參數： </p><table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>url</td> <td>連結位址</td> <td>string</td> </tr> </tbody> </table> <p>響應json數據：<br><code>{“resultCode”：“ok”，“data”：{“serverTime”：“1599116231440”}}</code></p> <h4 id="h4-inet-hash_hmac-parameter-1-parameter-2-parameter-3-"><a name="inet.hash_hmac（Parameter 1，Parameter 2，Parameter 3）；" class="reference-link"></a><span class="header-link octicon octicon-link"></span>inet.hash_hmac（Parameter 1，Parameter 2，Parameter 3）；</h4><p>根據秘鑰和加密管道進行加密<br>參數： </p><table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> <th>資料類型</th> </tr> </thead> <tbody> <tr> <td>Parameter 1</td> <td>加密管道（sha256；md5；sha512等等）</td> <td>string</td> </tr> <tr> <td>Parameter 2</td> <td>需要進行加密的字串</td> <td>string</td> </tr> <tr> <td>Parameter 3</td> <td>秘鑰</td> <td>string</td> </tr> </tbody> </table> <h4 id="h4-inet-timestamp-"><a name="inet.timestamp（）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>inet.timestamp（）</h4><p>獲取時間戳記<br>參數：無<br>響應number數據：<br><code>1599117673.123</code></p> <h4 id="h4-inet-utf8toansi-parameter-1-"><a name="inet.utf8toansi（Parameter 1）" class="reference-link"></a><span class="header-link octicon octicon-link"></span>inet.utf8toansi（Parameter 1）</h4><p>把utf8編碼資料轉換成ansi編碼</p> <table> <thead> <tr> <th>欄位名稱</th> <th>描述</th> </tr> </thead> <tbody> <tr> <td>Parameter 1</td> <td>需要轉換的數據</td> </tr> </tbody> </table> </body> </html>
